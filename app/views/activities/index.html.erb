<div class="container">

  <div class="row justify-content-center barr-search">
    <div class="d-flex justify-content-end align-items-start mb-3">
      <%= form_with url: activities_path, method: :get, class: "d-flex" do %>
        <%= text_field_tag :query,
          params[:query],
          class: "form-control",
          placeholder: "Looking for something else?"
        %>
        <%= submit_tag "Search", class: "button" %>
      <% end %>
    </div>
  <div class="small-card card-box-shadow row">
    <div class="card-grid col-sm-8">
      <% @activities.each do |activity| %>
        <div class="card flex-grow-1">
          <div class="card-body">
          <% if activity.image_url %>
             <img src="<%= activity.image_url %>" class="card-img-top" alt="...">
            <% else %>
            <img src="https://tinypng.com/images/social/website.jpg" class="card-img-top" alt="...">
          <% end %>
          <%# <%= link_to "Like", activity_likes_path(activity), data: {turbo_method: :post, turbo_confirm: "Add to favs?"} %>

          <% @activity = activity %>

          <% if current_user.likes.where(activity: activity).empty? %>
            <%= simple_form_for [@activity, @like] do |f| %>
              <%= f.button :button do %>
              <i class="fa-regular fa-heart"></i>
              <% end %>
            <% end %>
            <% else %>
              <%= link_to like_path(current_user.likes.where(activity: activity).first), data: {turbo_method: :delete} do %>
              <i class="fa-solid fa-heart"></i>
              <% end %>
          <% end %>

            <h6 class="card-title text-capitalize"><%= activity.name.capitalize %></h6>
            <p class="card-title text-capitalize card-location"> <%= activity.location.split.last %> </p>
            <%= link_to "Look it!", activity_path(activity), class: "button activity-button"  %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="map col-sm-4">
        <div style="width: 400px; height: 100vh; position: sticky; top: 0;"
            data-controller="map"
            data-map-markers-value="<%= @markers.to_json %>"
            data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
        </div>
    </div>
  </div>

</div>
